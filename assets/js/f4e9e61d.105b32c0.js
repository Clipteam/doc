"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[97],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return m}});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),c=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},s=function(e){var n=c(e.components);return r.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=c(t),m=a,h=d["".concat(p,".").concat(m)]||d[m]||u[m]||o;return t?r.createElement(h,i(i({ref:n},s),{},{components:t})):r.createElement(h,i({ref:n},s))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=d;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var c=2;c<o;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},206:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return u}});var r=t(7462),a=t(3366),o=(t(7294),t(3905)),i=["components"],l={sidebar_position:6,title:"Advanced Blocks API Usage"},p=void 0,c={unversionedId:"developer/advanced-block-usage",id:"developer/advanced-block-usage",title:"Advanced Blocks API Usage",description:"Add/remove blocks in one times.",source:"@site/docs/developer/advanced-block-usage.md",sourceDirName:"developer",slug:"/developer/advanced-block-usage",permalink:"/developer/advanced-block-usage",editUrl:"https://github.com/Clipteam/doc/edit/master/docs/developer/advanced-block-usage.md",tags:[],version:"current",lastUpdatedBy:"SimonShiki",lastUpdatedAt:1658363162,formattedLastUpdatedAt:"7/21/2022",sidebarPosition:6,frontMatter:{sidebar_position:6,title:"Advanced Blocks API Usage"},sidebar:"docs",previous:{title:"Add a block",permalink:"/developer/block"},next:{title:"Localization",permalink:"/developer/i18n"}},s={},u=[{value:"Add/remove blocks in one times.",id:"addremove-blocks-in-one-times",level:2},{value:"Menu",id:"menu",level:2},{value:"Hat",id:"hat",level:2},{value:"Branch",id:"branch",level:2}],d={toc:u};function m(e){var n=e.components,t=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"addremove-blocks-in-one-times"},"Add/remove blocks in one times."),(0,o.kt)("p",null,"ClipCC provides support for add/remove blocks in one times. You can use ",(0,o.kt)("inlineCode",{parentName:"p"},"api.addBlocks(blocks: BlockPrototype[])")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"api.removeBlocks(blocksOpcode: string[])")," to implement them."),(0,o.kt)("h2",{id:"menu"},"Menu"),(0,o.kt)("p",null,"ClipCC provides support for menu input since version 3.1.2. The correct way to define a menu's inputs is to define a ",(0,o.kt)("inlineCode",{parentName:"p"},"menu")," property within parameter."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"param: {\n    PARAMETER: {\n        type: type.ParameterType.STRING,\n       menu: [{\n           messageId: 'example.extension.menu.type',\n           value: 'type'\n            }, {\n                   messageId: 'example.extension.menu.rainbow',\n                   value: 'rainbow'\n            }, {\n                  messageId: 'example.extension.menu.zoom',\n                  value: 'zoom'\n            }],\n           default: 'rainbow'\n      }\n}\n")),(0,o.kt)("p",null,"If you want to define a menu that cannot embed reporters, then set the ",(0,o.kt)("inlineCode",{parentName:"p"},"field")," property to true."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"param: {\n    PARAMETER: {\n        type: type.ParameterType.STRING,\n        default: 'something',\n        field: true,\n        menu: [...]\n      }\n},\n")),(0,o.kt)("h2",{id:"hat"},"Hat"),(0,o.kt)("p",null,"There's a simple example illustrating how to define a block of type ",(0,o.kt)("inlineCode",{parentName:"p"},"HAT"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"api.addBlock({\n        opcode: 'example.hat',\n        type: type.BlockType.HAT,\n        messageId: 'example.hat',\n        categoryId: 'example.category',\n        param: {\n            CONDITION: {\n                type: type.ParameterType.BOOLEAN\n            }\n        },\n        function: (args) => {\n            if (!!hasReported) {\n                window.hasReported = false;\n                return false;\n            }\n            const result = !!args.CONDITION;\n            if (result) {\n                hasReported = true;\n                return true;\n            }\n            return false;\n        }\n});\n")),(0,o.kt)("p",null,'When the block is dragged into the workspace, the entire project will be under the illusion of "unstoppable" but no scripts are being executed. The editor checks every frame to see if this HAT is triggerred. The hat block will only be called normally if the previous frame returns ',(0,o.kt)("inlineCode",{parentName:"p"},"false")," and the current frame returns ",(0,o.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,o.kt)("h2",{id:"branch"},"Branch"),(0,o.kt)("p",null,"ClipCC provides support for menu input since version 3.1.4. Here's the definition:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},"api.addBlock({\n    opcode: 'example.if',\n    type: type.BlockType.COMMAND,\n    messageId: 'example.if',\n    categoryId: 'example.category',\n    branchCount: 1,\n    param: {\n        COND: {\n            type: type.ParameterType.BOOLEAN\n        }\n    },\n    function: (args, util) => {\n        // If the condition is true, start the branch.\n        if (!!args.COND) util.startBranch(1, false);\n    }\n});\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="en.json"',title:'"en.json"'},'{\n    "example.if": "if [COND] [SUBSTACK]"\n}\n')),(0,o.kt)("p",null,'\u3000\u3000You should specify "branchCount" in BlockPrototype, which means the number of branches of the block. You should also specify the location of the branch in the translation file and name it with ',"[SUBSTACKX]",".\n\u3000\u3000For a BRANCH block, You can control the flow through the ",(0,o.kt)("inlineCode",{parentName:"p"},"startBranch")," provided in the ",(0,o.kt)("inlineCode",{parentName:"p"},"util")," object."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"/**\n* Start a branch in the current block.\n* @param {number} branchNum Which branch to step to (i.e., 1, 2).\n* @param {boolean} isLoop Whether this block is a loop.\n*/\nstartBranch (branchNum, isLoop) {...}\n")),(0,o.kt)("p",null,"When the ",(0,o.kt)("inlineCode",{parentName:"p"},"isLoop")," parameter is specified as true, the blocks will be executed repeatedly until no startBranch is triggered. When false, the block will be ejected immediately. When the ",(0,o.kt)("inlineCode",{parentName:"p"},"branchNum")," parameter is not specified, it defaults to 1. There's an ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/SimonShiki/neurons"},"example"),"."),(0,o.kt)("p",null,"Writing this type of block usually requires modifications to the thread and sequencer, so you need to have a certain level of understanding of the Scratch/ClipCC source code. In general, we do not recommend that you create such blocks."))}m.isMDXComponent=!0}}]);