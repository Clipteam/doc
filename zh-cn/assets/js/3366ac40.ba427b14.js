"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[140],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=c(n),m=i,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||r;return n?a.createElement(h,l(l({ref:t},p),{},{components:n})):a.createElement(h,l({ref:t},p))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var c=2;c<r;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1432:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return o},metadata:function(){return c},toc:function(){return u}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),l=["components"],o={sidebar_position:3,title:"\u5f00\u53d1"},s=void 0,c={unversionedId:"development",id:"development",title:"\u5f00\u53d1",description:"\u5b89\u88c5",source:"@site/i18n/zh-cn/docusaurus-plugin-content-docs/current/development.md",sourceDirName:".",slug:"/development",permalink:"/zh-cn/development",editUrl:"https://github.com/Clipteam/doc/edit/master/i18n/zh-cn/docusaurus-plugin-content-docs/current/development.md",tags:[],version:"current",lastUpdatedBy:"SinanGentoo",lastUpdatedAt:1649928421,formattedLastUpdatedAt:"2022/4/14",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"\u5f00\u53d1"},sidebar:"docs",previous:{title:"\u793e\u533a\u7248\u8bf4\u660e",permalink:"/zh-cn/community"},next:{title:"Features",permalink:"/zh-cn/category/features"}},p={},u=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u5728\u73b0\u6709\u7684 React \u5e94\u7528\u4e2d\u4f7f\u7528",id:"\u5728\u73b0\u6709\u7684-react-\u5e94\u7528\u4e2d\u4f7f\u7528",level:3},{value:"\u4e0b\u8f7d\u6e90\u7801\u5e76\u8fd0\u884c",id:"\u4e0b\u8f7d\u6e90\u7801\u5e76\u8fd0\u884c",level:3},{value:"\u548c\u539f\u7248 Scratch \u7684\u533a\u522b",id:"\u548c\u539f\u7248-scratch-\u7684\u533a\u522b",level:3},{value:"\u6d4b\u8bd5",id:"\u6d4b\u8bd5",level:2},{value:"Documentation",id:"documentation",level:3},{value:"Running tests",id:"running-tests",level:3},{value:"Main testing command",id:"main-testing-command",level:4},{value:"Running unit tests",id:"running-unit-tests",level:4},{value:"Running integration tests",id:"running-integration-tests",level:4},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Ignoring optional dependencies",id:"ignoring-optional-dependencies",level:3},{value:"Resolving dependencies",id:"resolving-dependencies",level:3},{value:"Transitions",id:"transitions",level:3},{value:"How transitions relate to loading states",id:"how-transitions-relate-to-loading-states",level:3}],d={toc:u};function m(e){var t=e.components,o=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"\u5b89\u88c5"},"\u5b89\u88c5"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\u8bf7\u786e\u4fdd\u5728\u5f00\u59cb\u4e4b\u524d\u5df2\u7ecf\u5b89\u88c5\u4e86",(0,r.kt)("a",{parentName:"p",href:"https:////www.nodejs.org"},"Node.js"),"\u548c",(0,r.kt)("a",{parentName:"p",href:"https://git-scm.com/"},"Git"),"\uff0c\u6b64\u5916\u6211\u4eec\u5efa\u8bae\u4f7f\u7528 Linux \u800c\u4e0d\u662f Windows \u8fdb\u884c\u914d\u7f6e"))),(0,r.kt)("h3",{id:"\u5728\u73b0\u6709\u7684-react-\u5e94\u7528\u4e2d\u4f7f\u7528"},"\u5728\u73b0\u6709\u7684 React \u5e94\u7528\u4e2d\u4f7f\u7528"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn install clipcc-gui@latest\n")),(0,r.kt)("p",null,"\u6216\u8005"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn install https://github.com/Clipteam/clipcc-gui.git\n")),(0,r.kt)("h3",{id:"\u4e0b\u8f7d\u6e90\u7801\u5e76\u8fd0\u884c"},"\u4e0b\u8f7d\u6e90\u7801\u5e76\u8fd0\u884c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/Clipteam/clipcc-gui.git\ncd clipcc-gui\nyarn install\nyarn start\n")),(0,r.kt)("p",null,"\u7136\u540e\u524d\u5f80 ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:8601/"},"http://localhost:8601/"),"\u67e5\u770b\u8fd0\u884c\u8f93\u51fa"),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u60f3\u8981\u7f16\u8f91",(0,r.kt)("inlineCode",{parentName:"p"},"clipcc-vm"),"\u6216",(0,r.kt)("inlineCode",{parentName:"p"},"clipcc-block"),"\uff0c\u8bf7\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn link")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# \u8bf7\u5148\u5728\u5de5\u4f5c\u76ee\u5f55\u4e2dclone\u4f60\u9700\u8981\u7684\u4ed3\u5e93\ncd clipcc-vm && yarn && yarn link\ncd clipcc-block && yarn\n# \u7f16\u8bd1clipcc-block\u5e76link\u5b83\uff0c\u9700\u8981Python 3\nyarn build\nyarn link\n# ...\ncd clipcc-gui\nyarn link clipcc-vm clipcc-block\nyarn start\n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\u53ea\u6709 ",(0,r.kt)("inlineCode",{parentName:"p"},"clipcc-vm")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"clipcc-gui")," \u652f\u6301\u70ed\u91cd\u8f7d"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u679c\u4f60\u9700\u8981\u5728\u5176\u4ed6\u5e94\u7528\u4e2d\u5f15\u7528 ",(0,r.kt)("inlineCode",{parentName:"strong"},"clipcc-gui")," \u7684\u672c\u5730\u526f\u672c\uff0c\u4f60\u9700\u8981\u5148\u6267\u884c ",(0,r.kt)("inlineCode",{parentName:"strong"},"yarn build:dist")," ")),(0,r.kt)("p",null,"\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528Yarn\u5de5\u4f5c\u533a, \u8be6\u60c5",(0,r.kt)("a",{parentName:"p",href:"hhttps://classic.yarnpkg.com/blog/2017/08/02/introducing-workspaces/"},"\u70b9\u6b64")),(0,r.kt)("h3",{id:"\u548c\u539f\u7248-scratch-\u7684\u533a\u522b"},"\u548c\u539f\u7248 Scratch \u7684\u533a\u522b"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"clipcc-gui \u4f7f\u7528 React 17.0.2 \u800c\u4e0d\u662f React 16.2"),(0,r.kt)("li",{parentName:"ol"},"clipcc-block \u91cd\u5199\u4e86\u7f16\u8bd1\u811a\u672c\u4ee5\u4f7f\u7528 Python3\uff0c\u5e76\u53ef\u4ee5\u5728 Windows \u4e0a\u8fd0\u884c"),(0,r.kt)("li",{parentName:"ol"},"\u5207\u6362\u5305\u7ba1\u7406\u5668\u4e3a Yarn")),(0,r.kt)("h2",{id:"\u6d4b\u8bd5"},"\u6d4b\u8bd5"),(0,r.kt)("h3",{id:"documentation"},"Documentation"),(0,r.kt)("p",null,"You may want to review the documentation for ",(0,r.kt)("a",{parentName:"p",href:"https://facebook.github.io/jest/docs/en/api.html"},"Jest")," and ",(0,r.kt)("a",{parentName:"p",href:"http://airbnb.io/enzyme/docs/api/"},"Enzyme")," as you write your tests."),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"https://facebook.github.io/jest/docs/en/cli.html#content"},"jest cli docs")," for more options."),(0,r.kt)("h3",{id:"running-tests"},"Running tests"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"NOTE: If you're a Windows user, please run these scripts in Windows ",(0,r.kt)("inlineCode",{parentName:"em"},"cmd.exe"),"  instead of Git Bash/MINGW64.")),(0,r.kt)("p",null,"Before running any test, make sure you have run ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn install")," from this (clipcc-gui) repository's top level."),(0,r.kt)("h4",{id:"main-testing-command"},"Main testing command"),(0,r.kt)("p",null,"To run linter, unit tests, build, and integration tests, all at once:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn test\n")),(0,r.kt)("h4",{id:"running-unit-tests"},"Running unit tests"),(0,r.kt)("p",null,"To run unit tests in isolation:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn run test:unit\n")),(0,r.kt)("p",null,"To run unit tests in watch mode (watches for code changes and continuously runs tests):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn run test:unit -- --watch\n")),(0,r.kt)("p",null,"You can run a single file of integration tests (in this example, the ",(0,r.kt)("inlineCode",{parentName:"p"},"button")," tests):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$(yarn bin)/jest --runInBand test/unit/components/button.test.jsx\n")),(0,r.kt)("h4",{id:"running-integration-tests"},"Running integration tests"),(0,r.kt)("p",null,"Integration tests use a headless browser to manipulate the actual HTML and javascript that the repo\nproduces. You will not see this activity (though you can hear it when sounds are played!)."),(0,r.kt)("p",null,"Note that integration tests require you to first create a build that can be loaded in a browser:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn run build\n")),(0,r.kt)("p",null,"Then, you can run all integration tests:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn run test:integration\n")),(0,r.kt)("p",null,"Or, you can run a single file of integration tests (in this example, the ",(0,r.kt)("inlineCode",{parentName:"p"},"backpack")," tests):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$(yarn bin)/jest --runInBand test/integration/backpack.test.js\n")),(0,r.kt)("p",null,"If you want to watch the browser as it runs the test, rather than running headless, use:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"USE_HEADLESS=no $(yarn bin)/jest --runInBand test/integration/backpack.test.js\n")),(0,r.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,r.kt)("h3",{id:"ignoring-optional-dependencies"},"Ignoring optional dependencies"),(0,r.kt)("p",null,"When running ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn install"),", you can get warnings about optionsl dependencies:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm WARN optional Skipping failed optional dependency /chokidar/fsevents:\nnpm WARN notsup Not compatible with your operating system or architecture: fsevents@1.2.7\n")),(0,r.kt)("p",null,"You can suppress them by adding the ",(0,r.kt)("inlineCode",{parentName:"p"},"no-optional")," switch:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"yarn install --no-optional\n")),(0,r.kt)("p",null,"Further reading: ",(0,r.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/36725181/not-compatible-with-your-operating-system-or-architecture-fsevents1-0-11"},"Stack Overflow")),(0,r.kt)("h3",{id:"resolving-dependencies"},"Resolving dependencies"),(0,r.kt)("p",null,"When installing for the first time, you can get warnings that need to be resolved:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm WARN eslint-config-scratch@5.0.0 requires a peer of babel-eslint@^8.0.1 but none was installed.\nnpm WARN eslint-config-scratch@5.0.0 requires a peer of eslint@^4.0 but none was installed.\nnpm WARN scratch-paint@0.2.0-prerelease.20190318170811 requires a peer of react-intl-redux@^0.7 but none was installed.\nnpm WARN scratch-paint@0.2.0-prerelease.20190318170811 requires a peer of react-responsive@^4 but none was installed.\n")),(0,r.kt)("p",null,"You can check which versions are available:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"yarn view react-intl-redux@0.* version\n")),(0,r.kt)("p",null,"You will need to install the required version:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"yarn install  --no-optional --save-dev react-intl-redux@^0.7\n")),(0,r.kt)("p",null,"The dependency itself might have more missing dependencies, which will show up like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"user@machine:~/sources/scratch/clipcc-gui (491-translatable-library-objects)$ yarn install  --no-optional --save-dev react-intl-redux@^0.7\nclipcc-gui@0.1.0 /media/cuideigin/Linux/sources/scratch/clipcc-gui\n\u251c\u2500\u2500 react-intl-redux@0.7.0\n\u2514\u2500\u2500 UNMET PEER DEPENDENCY react-responsive@5.0.0\n")),(0,r.kt)("p",null,"You will need to install those as well:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"yarn install  --no-optional --save-dev react-responsive@^5.0.0\n")),(0,r.kt)("p",null,"Further reading: ",(0,r.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/46602286/npm-requires-a-peer-of-but-all-peers-are-in-package-json-and-node-modules"},"Stack Overflow")),(0,r.kt)("h3",{id:"transitions"},"Transitions"),(0,r.kt)("p",null,"These are names for the action which causes a state change. Some examples are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"START_FETCHING_NEW"),","),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DONE_FETCHING_WITH_ID"),","),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"DONE_LOADING_VM_WITH_ID"),","),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"SET_PROJECT_ID"),","),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"START_AUTO_UPDATING"),",")),(0,r.kt)("h3",{id:"how-transitions-relate-to-loading-states"},"How transitions relate to loading states"),(0,r.kt)("p",null,"Like this diagram of the project state machine shows, various transition actions can move us from one loading state to another:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Project state diagram",src:n(591).Z,width:"1381",height:"1012"})),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Note: for clarity, the diagram above excludes states and transitions relating to error handling.")))}m.isMDXComponent=!0},591:function(e,t,n){t.Z=n.p+"assets/images/project_state_diagram-22fe12f7a4024b36e974f65dc5e19369.svg"}}]);